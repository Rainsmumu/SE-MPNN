Command line
python d:\Anaconda\envs\chemprop-fg\lib\site-packages\ipykernel_launcher.py --f=c:\Users\Blue\AppData\Roaming\jupyter\runtime\kernel-v2-5988lPhocZXZHnEz.json
Args
{'activation': 'ReLU',
 'adding_bond_types': True,
 'adding_h': False,
 'aggregation': 'mean',
 'aggregation_norm': 100,
 'atom_constraints': [],
 'atom_descriptor_scaling': True,
 'atom_descriptors': None,
 'atom_descriptors_path': None,
 'atom_descriptors_size': 0,
 'atom_features_size': 0,
 'atom_messages': False,
 'atom_targets': [],
 'batch_size': 50,
 'bias': False,
 'bias_solvent': False,
 'bond_constraints': [],
 'bond_descriptor_scaling': True,
 'bond_descriptors': None,
 'bond_descriptors_path': None,
 'bond_descriptors_size': 0,
 'bond_features_size': 0,
 'bond_targets': [],
 'cache_cutoff': 10000,
 'checkpoint_dir': None,
 'checkpoint_frzn': None,
 'checkpoint_path': None,
 'checkpoint_paths': None,
 'class_balance': False,
 'config_path': None,
 'constraints_path': None,
 'crossval_index_dir': None,
 'crossval_index_file': None,
 'crossval_index_sets': None,
 'cuda': True,
 'data_path': 'data/tg_sub.csv',
 'data_weights_path': None,
 'dataset_type': 'regression',
 'depth': 3,
 'depth_solvent': 3,
 'device': device(type='cuda', index=0),
 'dropout': 0.0,
 'empty_cache': False,
 'ensemble_size': 1,
 'epochs': 70,
 'evidential_regularization': 0,
 'explicit_h': False,
 'extra_metrics': ['r2'],
 'features_generator': None,
 'features_only': False,
 'features_path': None,
 'features_scaling': True,
 'features_size': None,
 'ffn_hidden_size': 300,
 'ffn_num_layers': 2,
 'final_lr': 0.0001,
 'folds_file': None,
 'freeze_first_only': False,
 'frzn_ffn_layers': 0,
 'gpu': 0,
 'grad_clip': None,
 'hidden_size': 300,
 'hidden_size_solvent': 300,
 'ignore_columns': None,
 'init_lr': 0.0001,
 'is_atom_bond_targets': False,
 'keeping_atom_map': False,
 'log_frequency': 10,
 'loss_function': 'mse',
 'max_data_size': None,
 'max_lr': 0.001,
 'metric': 'rmse',
 'metrics': ['rmse', 'r2'],
 'minimize_score': True,
 'mpn_shared': False,
 'multiclass_num_classes': 3,
 'no_adding_bond_types': False,
 'no_atom_descriptor_scaling': False,
 'no_bond_descriptor_scaling': False,
 'no_cache_mol': False,
 'no_cuda': False,
 'no_features_scaling': False,
 'no_shared_atom_bond_ffn': False,
 'num_folds': 5,
 'num_lrs': 1,
 'num_tasks': 1,
 'num_workers': 8,
 'number_of_molecules': 4,
 'overwrite_default_atom_features': False,
 'overwrite_default_bond_features': False,
 'phase_features_path': None,
 'pytorch_seed': 0,
 'quiet': False,
 'reaction': False,
 'reaction_mode': 'reac_diff',
 'reaction_solvent': False,
 'resume_experiment': False,
 'save_dir': 'checkpoints/tg_sub_improved2',
 'save_preds': False,
 'save_smiles_splits': True,
 'seed': 0,
 'separate_test_atom_descriptors_path': None,
 'separate_test_bond_descriptors_path': None,
 'separate_test_constraints_path': None,
 'separate_test_features_path': None,
 'separate_test_path': None,
 'separate_test_phase_features_path': None,
 'separate_val_atom_descriptors_path': None,
 'separate_val_bond_descriptors_path': None,
 'separate_val_constraints_path': None,
 'separate_val_features_path': None,
 'separate_val_path': None,
 'separate_val_phase_features_path': None,
 'shared_atom_bond_ffn': True,
 'show_individual_scores': False,
 'smiles_columns': ['SMILES', 'SMILES_1', 'SMILES_2', 'SMILES_3'],
 'spectra_activation': 'exp',
 'spectra_phase_mask_path': None,
 'spectra_target_floor': 1e-08,
 'split_key_molecule': 0,
 'split_sizes': [0.8, 0.1, 0.1],
 'split_type': 'random',
 'target_columns': None,
 'target_weights': None,
 'task_names': ['tg'],
 'test': False,
 'test_fold_index': None,
 'train_data_size': None,
 'undirected': False,
 'use_custom_embeddings': True,
 'use_input_features': False,
 'val_fold_index': None,
 'warmup_epochs': 2.0,
 'weights_ffn_num_layers': 2}
Setting molecule featurization parameters to default.
Loading data
Number of tasks = 1
Fold 0
Splitting data with seed 5
Total size = 223 | train size = 178 | val size = 22 | test size = 23
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0-3): 4 x MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=600, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 709,801
Moving model to cuda
Epoch 0
Validation rmse = 40.982567
Validation r2 = 0.730508
Epoch 1
Validation rmse = 46.104813
Validation r2 = 0.658933
Epoch 2
Loss = 4.2326e-01, PNorm = 45.8726, GNorm = 5.6483, lr_0 = 9.3452e-04
Loss = 3.7256e-01, PNorm = 45.8779, GNorm = 9.0593, lr_0 = 9.2403e-04
Validation rmse = 42.110674
Validation r2 = 0.715467
Epoch 3
Validation rmse = 48.728102
Validation r2 = 0.619016
Epoch 4
Validation rmse = 41.290572
Validation r2 = 0.726442
Epoch 5
Loss = 2.7415e-01, PNorm = 45.9312, GNorm = 1.0038, lr_0 = 8.1614e-04
Validation rmse = 40.548576
Validation r2 = 0.736185
Epoch 6
Validation rmse = 41.342790
Validation r2 = 0.725750
Epoch 7
Validation rmse = 39.479896
Validation r2 = 0.749908
Epoch 8
Loss = 2.8635e-01, PNorm = 45.9732, GNorm = 2.8033, lr_0 = 7.2085e-04
Validation rmse = 35.662258
Validation r2 = 0.795936
Epoch 9
Validation rmse = 33.242820
Validation r2 = 0.822686
Epoch 10
Validation rmse = 32.050229
Validation r2 = 0.835180
Epoch 11
Loss = 2.4715e-01, PNorm = 46.0118, GNorm = 1.7985, lr_0 = 6.3668e-04
Validation rmse = 31.516041
Validation r2 = 0.840628
Epoch 12
Validation rmse = 31.021173
Validation r2 = 0.845594
Epoch 13
Validation rmse = 31.400137
Validation r2 = 0.841798
Epoch 14
Loss = 1.2378e-01, PNorm = 46.0557, GNorm = 2.5932, lr_0 = 5.5603e-04
Validation rmse = 31.294283
Validation r2 = 0.842863
Epoch 15
Validation rmse = 32.154463
Validation r2 = 0.834106
Epoch 16
Loss = 1.3496e-01, PNorm = 46.0874, GNorm = 2.2747, lr_0 = 4.9111e-04
Validation rmse = 31.195109
Validation r2 = 0.843858
Epoch 17
Validation rmse = 32.095993
Validation r2 = 0.834709
Epoch 18
Validation rmse = 32.022575
Validation r2 = 0.835464
Epoch 19
Loss = 1.1115e-01, PNorm = 46.1152, GNorm = 0.8652, lr_0 = 4.3377e-04
Validation rmse = 33.778552
Validation r2 = 0.816925
Epoch 20
Validation rmse = 30.986429
Validation r2 = 0.845940
Epoch 21
Validation rmse = 31.544119
Validation r2 = 0.840344
Epoch 22
Loss = 7.9293e-02, PNorm = 46.1393, GNorm = 1.8164, lr_0 = 3.8312e-04
Validation rmse = 31.251679
Validation r2 = 0.843291
Epoch 23
Validation rmse = 30.815689
Validation r2 = 0.847633
Epoch 24
Validation rmse = 30.767858
Validation r2 = 0.848105
Epoch 25
Loss = 9.2203e-02, PNorm = 46.1607, GNorm = 1.5215, lr_0 = 3.3839e-04
Validation rmse = 30.165617
Validation r2 = 0.853993
Epoch 26
Validation rmse = 32.868832
Validation r2 = 0.826653
Epoch 27
Validation rmse = 30.245543
Validation r2 = 0.853219
Epoch 28
Loss = 9.1297e-02, PNorm = 46.1803, GNorm = 1.0689, lr_0 = 2.9552e-04
Validation rmse = 31.554199
Validation r2 = 0.840242
Epoch 29
Validation rmse = 29.790420
Validation r2 = 0.857603
Epoch 30
Loss = 8.5458e-02, PNorm = 46.1950, GNorm = 4.7316, lr_0 = 2.6102e-04
Validation rmse = 29.869802
Validation r2 = 0.856843
Epoch 31
Validation rmse = 30.006175
Validation r2 = 0.855533
Epoch 32
Validation rmse = 29.796144
Validation r2 = 0.857548
Epoch 33
Loss = 7.5679e-02, PNorm = 46.2085, GNorm = 2.1504, lr_0 = 2.3054e-04
Validation rmse = 30.138828
Validation r2 = 0.854253
Epoch 34
Validation rmse = 29.767167
Validation r2 = 0.857825
Epoch 35
Validation rmse = 31.346260
Validation r2 = 0.842341
Epoch 36
Loss = 8.5278e-02, PNorm = 46.2198, GNorm = 3.4973, lr_0 = 2.0362e-04
Validation rmse = 29.626455
Validation r2 = 0.859166
Epoch 37
Validation rmse = 30.371722
Validation r2 = 0.851992
Epoch 38
Validation rmse = 29.720913
Validation r2 = 0.858267
Epoch 39
Loss = 6.2944e-02, PNorm = 46.2308, GNorm = 1.7891, lr_0 = 1.7783e-04
Validation rmse = 30.436248
Validation r2 = 0.851362
Epoch 40
Validation rmse = 29.941636
Validation r2 = 0.856154
Epoch 41
Validation rmse = 29.902840
Validation r2 = 0.856526
Epoch 42
Loss = 8.5396e-02, PNorm = 46.2393, GNorm = 0.4589, lr_0 = 1.5706e-04
Validation rmse = 29.554279
Validation r2 = 0.859851
Epoch 43
Validation rmse = 29.463316
Validation r2 = 0.860713
Epoch 44
Loss = 5.4673e-02, PNorm = 46.2469, GNorm = 1.6745, lr_0 = 1.3873e-04
Validation rmse = 29.550197
Validation r2 = 0.859890
Epoch 45
Validation rmse = 29.838325
Validation r2 = 0.857145
Epoch 46
Validation rmse = 29.359642
Validation r2 = 0.861691
Epoch 47
Loss = 5.8907e-02, PNorm = 46.2533, GNorm = 0.6626, lr_0 = 1.2253e-04
Loss = 3.6529e-02, PNorm = 46.2538, GNorm = 0.9407, lr_0 = 1.2115e-04
Validation rmse = 29.117653
Validation r2 = 0.863962
Epoch 48
Validation rmse = 29.294878
Validation r2 = 0.862301
Epoch 49
Validation rmse = 29.163021
Validation r2 = 0.863538
Epoch 50
Loss = 4.9538e-02, PNorm = 46.2587, GNorm = 0.5148, lr_0 = 1.0822e-04
Validation rmse = 29.244808
Validation r2 = 0.862771
Epoch 51
Validation rmse = 29.239096
Validation r2 = 0.862825
Epoch 52
Validation rmse = 29.332024
Validation r2 = 0.861951
Epoch 53
Loss = 4.9968e-02, PNorm = 46.2643, GNorm = 0.5416, lr_0 = 1.0000e-04
Validation rmse = 29.389115
Validation r2 = 0.861414
Epoch 54
Validation rmse = 29.219945
Validation r2 = 0.863004
Epoch 55
Validation rmse = 29.208120
Validation r2 = 0.863115
Epoch 56
Loss = 6.6357e-02, PNorm = 46.2694, GNorm = 0.4270, lr_0 = 1.0000e-04
Validation rmse = 29.238145
Validation r2 = 0.862834
Epoch 57
Validation rmse = 29.072408
Validation r2 = 0.864384
Epoch 58
Loss = 5.2876e-02, PNorm = 46.2747, GNorm = 1.3125, lr_0 = 1.0000e-04
Validation rmse = 29.460398
Validation r2 = 0.860740
Epoch 59
Validation rmse = 29.028861
Validation r2 = 0.864790
Epoch 60
Validation rmse = 29.180308
Validation r2 = 0.863376
Epoch 61
Loss = 5.3560e-02, PNorm = 46.2799, GNorm = 1.0784, lr_0 = 1.0000e-04
Loss = 2.1149e-02, PNorm = 46.2803, GNorm = 0.6239, lr_0 = 1.0000e-04
Validation rmse = 29.235382
Validation r2 = 0.862860
Epoch 62
Validation rmse = 29.589342
Validation r2 = 0.859519
Epoch 63
Validation rmse = 29.035469
Validation r2 = 0.864729
Epoch 64
Loss = 4.6562e-02, PNorm = 46.2850, GNorm = 0.5451, lr_0 = 1.0000e-04
Validation rmse = 29.114532
Validation r2 = 0.863991
Epoch 65
Validation rmse = 29.154260
Validation r2 = 0.863620
Epoch 66
Validation rmse = 28.880210
Validation r2 = 0.866172
Epoch 67
Loss = 3.8975e-02, PNorm = 46.2898, GNorm = 1.3073, lr_0 = 1.0000e-04
Validation rmse = 29.013540
Validation r2 = 0.864933
Epoch 68
Validation rmse = 28.835988
Validation r2 = 0.866581
Epoch 69
Validation rmse = 29.073234
Validation r2 = 0.864377
Model 0 best validation rmse = 28.835988 on epoch 68
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "encoder.encoder.1.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.1.W_i.weight".
Loading pretrained parameter "encoder.encoder.1.W_h.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.bias".
Loading pretrained parameter "encoder.encoder.2.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.2.W_i.weight".
Loading pretrained parameter "encoder.encoder.2.W_h.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.bias".
Loading pretrained parameter "encoder.encoder.3.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.3.W_i.weight".
Loading pretrained parameter "encoder.encoder.3.W_h.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test rmse = 25.199607
Model 0 test r2 = 0.856926
Ensemble test rmse = 25.199607
Ensemble test r2 = 0.856926
Fold 1
Splitting data with seed 1
Total size = 223 | train size = 178 | val size = 22 | test size = 23
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0-3): 4 x MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=600, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 709,801
Moving model to cuda
Epoch 0
Validation rmse = 56.459852
Validation r2 = 0.465873
Epoch 1
Validation rmse = 52.971541
Validation r2 = 0.529835
Epoch 2
Loss = 3.2029e-01, PNorm = 45.8757, GNorm = 4.3655, lr_0 = 9.3452e-04
Loss = 4.1114e-01, PNorm = 45.8815, GNorm = 1.4049, lr_0 = 9.2403e-04
Validation rmse = 53.387682
Validation r2 = 0.522419
Epoch 3
Validation rmse = 55.292810
Validation r2 = 0.487726
Epoch 4
Validation rmse = 54.761761
Validation r2 = 0.497519
Epoch 5
Loss = 3.1088e-01, PNorm = 45.9276, GNorm = 1.8920, lr_0 = 8.1614e-04
Validation rmse = 48.889530
Validation r2 = 0.599505
Epoch 6
Validation rmse = 47.766145
Validation r2 = 0.617699
Epoch 7
Validation rmse = 43.360393
Validation r2 = 0.684970
Epoch 8
Loss = 2.6923e-01, PNorm = 45.9686, GNorm = 2.9824, lr_0 = 7.2085e-04
Validation rmse = 45.676685
Validation r2 = 0.650414
Epoch 9
Validation rmse = 41.345589
Validation r2 = 0.713567
Epoch 10
Validation rmse = 40.646042
Validation r2 = 0.723177
Epoch 11
Loss = 2.5357e-01, PNorm = 46.0101, GNorm = 1.3438, lr_0 = 6.3668e-04
Validation rmse = 39.764998
Validation r2 = 0.735048
Epoch 12
Validation rmse = 38.680758
Validation r2 = 0.749300
Epoch 13
Validation rmse = 37.624547
Validation r2 = 0.762804
Epoch 14
Loss = 1.4910e-01, PNorm = 46.0536, GNorm = 0.9602, lr_0 = 5.5603e-04
Validation rmse = 36.476412
Validation r2 = 0.777059
Epoch 15
Validation rmse = 36.842092
Validation r2 = 0.772567
Epoch 16
Loss = 1.3778e-01, PNorm = 46.0912, GNorm = 1.6329, lr_0 = 4.9111e-04
Validation rmse = 33.780989
Validation r2 = 0.808790
Epoch 17
Validation rmse = 34.704222
Validation r2 = 0.798196
Epoch 18
Validation rmse = 33.386482
Validation r2 = 0.813230
Epoch 19
Loss = 1.2040e-01, PNorm = 46.1271, GNorm = 1.5385, lr_0 = 4.3377e-04
Validation rmse = 32.455880
Validation r2 = 0.823497
Epoch 20
Validation rmse = 31.902349
Validation r2 = 0.829466
Epoch 21
Validation rmse = 31.065478
Validation r2 = 0.838296
Epoch 22
Loss = 1.1964e-01, PNorm = 46.1609, GNorm = 2.5715, lr_0 = 3.8312e-04
Validation rmse = 30.940257
Validation r2 = 0.839597
Epoch 23
Validation rmse = 35.676794
Validation r2 = 0.786727
Epoch 24
Validation rmse = 30.407479
Validation r2 = 0.845073
Epoch 25
Loss = 9.7487e-02, PNorm = 46.1866, GNorm = 0.9422, lr_0 = 3.3839e-04
Validation rmse = 32.572178
Validation r2 = 0.822230
Epoch 26
Validation rmse = 30.492104
Validation r2 = 0.844210
Epoch 27
Validation rmse = 32.279698
Validation r2 = 0.825408
Epoch 28
Loss = 7.4139e-02, PNorm = 46.2102, GNorm = 2.3039, lr_0 = 2.9552e-04
Validation rmse = 30.043748
Validation r2 = 0.848758
Epoch 29
Validation rmse = 31.384973
Validation r2 = 0.834953
Epoch 30
Loss = 8.0534e-02, PNorm = 46.2289, GNorm = 1.1303, lr_0 = 2.6102e-04
Validation rmse = 29.744639
Validation r2 = 0.851754
Epoch 31
Validation rmse = 29.328232
Validation r2 = 0.855876
Epoch 32
Validation rmse = 30.446926
Validation r2 = 0.844671
Epoch 33
Loss = 7.1309e-02, PNorm = 46.2439, GNorm = 0.6587, lr_0 = 2.3054e-04
Validation rmse = 29.410383
Validation r2 = 0.855067
Epoch 34
Validation rmse = 29.572961
Validation r2 = 0.853460
Epoch 35
Validation rmse = 29.171894
Validation r2 = 0.857408
Epoch 36
Loss = 5.0679e-02, PNorm = 46.2576, GNorm = 0.4220, lr_0 = 2.0362e-04
Validation rmse = 29.371085
Validation r2 = 0.855454
Epoch 37
Validation rmse = 29.701466
Validation r2 = 0.852184
Epoch 38
Validation rmse = 28.989632
Validation r2 = 0.859184
Epoch 39
Loss = 6.6291e-02, PNorm = 46.2699, GNorm = 2.3719, lr_0 = 1.7783e-04
Validation rmse = 30.309908
Validation r2 = 0.846066
Epoch 40
Validation rmse = 29.017961
Validation r2 = 0.858909
Epoch 41
Validation rmse = 29.843370
Validation r2 = 0.850768
Epoch 42
Loss = 3.1818e-02, PNorm = 46.2792, GNorm = 0.9944, lr_0 = 1.5706e-04
Validation rmse = 29.253256
Validation r2 = 0.856612
Epoch 43
Validation rmse = 28.856575
Validation r2 = 0.860474
Epoch 44
Loss = 5.7780e-02, PNorm = 46.2872, GNorm = 1.4129, lr_0 = 1.3873e-04
Validation rmse = 30.045985
Validation r2 = 0.848735
Epoch 45
Validation rmse = 28.657638
Validation r2 = 0.862391
Epoch 46
Validation rmse = 29.453615
Validation r2 = 0.854641
Epoch 47
Loss = 5.9567e-02, PNorm = 46.2943, GNorm = 1.9021, lr_0 = 1.2253e-04
Loss = 4.1432e-02, PNorm = 46.2949, GNorm = 0.8934, lr_0 = 1.2115e-04
Validation rmse = 28.641701
Validation r2 = 0.862544
Epoch 48
Validation rmse = 29.104305
Validation r2 = 0.858068
Epoch 49
Validation rmse = 29.194244
Validation r2 = 0.857190
Epoch 50
Loss = 4.3160e-02, PNorm = 46.3004, GNorm = 1.3815, lr_0 = 1.0822e-04
Validation rmse = 28.920500
Validation r2 = 0.859855
Epoch 51
Validation rmse = 28.842130
Validation r2 = 0.860614
Epoch 52
Validation rmse = 28.830598
Validation r2 = 0.860725
Epoch 53
Loss = 4.7312e-02, PNorm = 46.3062, GNorm = 1.3766, lr_0 = 1.0000e-04
Validation rmse = 29.071641
Validation r2 = 0.858387
Epoch 54
Validation rmse = 28.310531
Validation r2 = 0.865705
Epoch 55
Validation rmse = 29.126506
Validation r2 = 0.857852
Epoch 56
Loss = 6.9587e-02, PNorm = 46.3113, GNorm = 1.1155, lr_0 = 1.0000e-04
Validation rmse = 29.129594
Validation r2 = 0.857821
Epoch 57
Validation rmse = 28.842172
Validation r2 = 0.860613
Epoch 58
Loss = 5.0489e-02, PNorm = 46.3160, GNorm = 0.6261, lr_0 = 1.0000e-04
Validation rmse = 28.494907
Validation r2 = 0.863950
Epoch 59
Validation rmse = 29.174324
Validation r2 = 0.857384
Epoch 60
Validation rmse = 28.988986
Validation r2 = 0.859191
Epoch 61
Loss = 5.4651e-02, PNorm = 46.3210, GNorm = 0.7335, lr_0 = 1.0000e-04
Loss = 2.8502e-02, PNorm = 46.3214, GNorm = 0.4637, lr_0 = 1.0000e-04
Validation rmse = 29.229570
Validation r2 = 0.856844
Epoch 62
Validation rmse = 28.782260
Validation r2 = 0.861192
Epoch 63
Validation rmse = 28.539821
Validation r2 = 0.863520
Epoch 64
Loss = 5.3949e-02, PNorm = 46.3259, GNorm = 1.1073, lr_0 = 1.0000e-04
Validation rmse = 28.747081
Validation r2 = 0.861531
Epoch 65
Validation rmse = 28.816115
Validation r2 = 0.860865
Epoch 66
Validation rmse = 28.751037
Validation r2 = 0.861493
Epoch 67
Loss = 4.7334e-02, PNorm = 46.3306, GNorm = 0.6806, lr_0 = 1.0000e-04
Validation rmse = 28.725717
Validation r2 = 0.861737
Epoch 68
Validation rmse = 28.819857
Validation r2 = 0.860829
Epoch 69
Validation rmse = 28.416948
Validation r2 = 0.864693
Model 0 best validation rmse = 28.310531 on epoch 54
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "encoder.encoder.1.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.1.W_i.weight".
Loading pretrained parameter "encoder.encoder.1.W_h.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.bias".
Loading pretrained parameter "encoder.encoder.2.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.2.W_i.weight".
Loading pretrained parameter "encoder.encoder.2.W_h.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.bias".
Loading pretrained parameter "encoder.encoder.3.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.3.W_i.weight".
Loading pretrained parameter "encoder.encoder.3.W_h.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test rmse = 25.019933
Model 0 test r2 = 0.909197
Ensemble test rmse = 25.019933
Ensemble test r2 = 0.909197
Fold 2
Splitting data with seed 2
Total size = 223 | train size = 178 | val size = 22 | test size = 23
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0-3): 4 x MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=600, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 709,801
Moving model to cuda
Epoch 0
Validation rmse = 53.721219
Validation r2 = 0.127823
Epoch 1
Validation rmse = 37.117745
Validation r2 = 0.583633
Epoch 2
Loss = 3.8982e-01, PNorm = 45.8723, GNorm = 2.2676, lr_0 = 9.3452e-04
Loss = 3.1968e-01, PNorm = 45.8778, GNorm = 2.1088, lr_0 = 9.2403e-04
Validation rmse = 41.608142
Validation r2 = 0.476798
Epoch 3
Validation rmse = 36.964357
Validation r2 = 0.587067
Epoch 4
Validation rmse = 32.722237
Validation r2 = 0.676407
Epoch 5
Loss = 3.3592e-01, PNorm = 45.9336, GNorm = 4.8079, lr_0 = 8.1614e-04
Validation rmse = 38.205843
Validation r2 = 0.558864
Epoch 6
Validation rmse = 34.408011
Validation r2 = 0.642207
Epoch 7
Validation rmse = 35.059840
Validation r2 = 0.628522
Epoch 8
Loss = 2.2557e-01, PNorm = 45.9796, GNorm = 2.3115, lr_0 = 7.2085e-04
Validation rmse = 34.960202
Validation r2 = 0.630631
Epoch 9
Validation rmse = 36.590209
Validation r2 = 0.595384
Epoch 10
Validation rmse = 36.979131
Validation r2 = 0.586737
Epoch 11
Loss = 1.8319e-01, PNorm = 46.0267, GNorm = 3.3964, lr_0 = 6.3668e-04
Validation rmse = 37.150223
Validation r2 = 0.582904
Epoch 12
Validation rmse = 36.692333
Validation r2 = 0.593123
Epoch 13
Validation rmse = 36.284938
Validation r2 = 0.602107
Epoch 14
Loss = 1.2050e-01, PNorm = 46.0732, GNorm = 0.5100, lr_0 = 5.5603e-04
Validation rmse = 36.238708
Validation r2 = 0.603121
Epoch 15
Validation rmse = 36.723396
Validation r2 = 0.592433
Epoch 16
Loss = 1.1254e-01, PNorm = 46.1120, GNorm = 1.5096, lr_0 = 4.9111e-04
Validation rmse = 40.469553
Validation r2 = 0.505040
Epoch 17
Validation rmse = 38.939454
Validation r2 = 0.541760
Epoch 18
Validation rmse = 37.711486
Validation r2 = 0.570206
Epoch 19
Loss = 9.2571e-02, PNorm = 46.1403, GNorm = 1.9385, lr_0 = 4.3377e-04
Validation rmse = 36.061039
Validation r2 = 0.607003
Epoch 20
Validation rmse = 36.535358
Validation r2 = 0.596596
Epoch 21
Validation rmse = 37.608954
Validation r2 = 0.572540
Epoch 22
Loss = 7.0011e-02, PNorm = 46.1651, GNorm = 2.3555, lr_0 = 3.8312e-04
Validation rmse = 36.851015
Validation r2 = 0.589596
Epoch 23
Validation rmse = 38.197244
Validation r2 = 0.559062
Epoch 24
Validation rmse = 37.558805
Validation r2 = 0.573679
Epoch 25
Loss = 5.8822e-02, PNorm = 46.1857, GNorm = 2.1832, lr_0 = 3.3839e-04
Validation rmse = 36.345454
Validation r2 = 0.600779
Epoch 26
Validation rmse = 37.520196
Validation r2 = 0.574555
Epoch 27
Validation rmse = 37.533044
Validation r2 = 0.574264
Epoch 28
Loss = 6.8307e-02, PNorm = 46.2061, GNorm = 1.6600, lr_0 = 2.9552e-04
Validation rmse = 38.077166
Validation r2 = 0.561830
Epoch 29
Validation rmse = 37.654918
Validation r2 = 0.571494
Epoch 30
Loss = 6.1294e-02, PNorm = 46.2221, GNorm = 1.2578, lr_0 = 2.6102e-04
Validation rmse = 37.599997
Validation r2 = 0.572744
Epoch 31
Validation rmse = 37.248849
Validation r2 = 0.580687
Epoch 32
Validation rmse = 37.181878
Validation r2 = 0.582193
Epoch 33
Loss = 4.8309e-02, PNorm = 46.2357, GNorm = 0.5282, lr_0 = 2.3054e-04
Validation rmse = 36.888621
Validation r2 = 0.588758
Epoch 34
Validation rmse = 36.775957
Validation r2 = 0.591266
Epoch 35
Validation rmse = 36.918834
Validation r2 = 0.588084
Epoch 36
Loss = 5.1264e-02, PNorm = 46.2476, GNorm = 0.7811, lr_0 = 2.0362e-04
Validation rmse = 36.628199
Validation r2 = 0.594544
Epoch 37
Validation rmse = 37.073991
Validation r2 = 0.584614
Epoch 38
Validation rmse = 37.363775
Validation r2 = 0.578095
Epoch 39
Loss = 5.7602e-02, PNorm = 46.2588, GNorm = 0.6268, lr_0 = 1.7783e-04
Validation rmse = 37.476279
Validation r2 = 0.575551
Epoch 40
Validation rmse = 36.951609
Validation r2 = 0.587352
Epoch 41
Validation rmse = 36.982056
Validation r2 = 0.586672
Epoch 42
Loss = 2.8008e-02, PNorm = 46.2679, GNorm = 0.3853, lr_0 = 1.5706e-04
Validation rmse = 36.593675
Validation r2 = 0.595308
Epoch 43
Validation rmse = 36.873236
Validation r2 = 0.589101
Epoch 44
Loss = 4.7070e-02, PNorm = 46.2761, GNorm = 0.5702, lr_0 = 1.3873e-04
Validation rmse = 36.984637
Validation r2 = 0.586614
Epoch 45
Validation rmse = 36.994730
Validation r2 = 0.586388
Epoch 46
Validation rmse = 36.842367
Validation r2 = 0.589788
Epoch 47
Loss = 4.6740e-02, PNorm = 46.2831, GNorm = 1.3281, lr_0 = 1.2253e-04
Loss = 2.5535e-02, PNorm = 46.2837, GNorm = 1.4076, lr_0 = 1.2115e-04
Validation rmse = 36.996197
Validation r2 = 0.586356
Epoch 48
Validation rmse = 36.951321
Validation r2 = 0.587358
Epoch 49
Validation rmse = 36.657371
Validation r2 = 0.593898
Epoch 50
Loss = 2.9632e-02, PNorm = 46.2894, GNorm = 0.6102, lr_0 = 1.0822e-04
Validation rmse = 37.051851
Validation r2 = 0.585110
Epoch 51
Validation rmse = 36.890989
Validation r2 = 0.588705
Epoch 52
Validation rmse = 36.979299
Validation r2 = 0.586733
Epoch 53
Loss = 4.2917e-02, PNorm = 46.2954, GNorm = 0.8265, lr_0 = 1.0000e-04
Validation rmse = 36.932790
Validation r2 = 0.587772
Epoch 54
Validation rmse = 37.140091
Validation r2 = 0.583132
Epoch 55
Validation rmse = 37.082406
Validation r2 = 0.584426
Epoch 56
Loss = 2.5817e-02, PNorm = 46.3009, GNorm = 0.8796, lr_0 = 1.0000e-04
Validation rmse = 36.932520
Validation r2 = 0.587778
Epoch 57
Validation rmse = 37.235641
Validation r2 = 0.580984
Epoch 58
Loss = 3.8117e-02, PNorm = 46.3062, GNorm = 1.0260, lr_0 = 1.0000e-04
Validation rmse = 37.013370
Validation r2 = 0.585971
Epoch 59
Validation rmse = 37.094357
Validation r2 = 0.584158
Epoch 60
Validation rmse = 37.325738
Validation r2 = 0.578954
Epoch 61
Loss = 4.1320e-02, PNorm = 46.3114, GNorm = 0.2975, lr_0 = 1.0000e-04
Loss = 1.8925e-02, PNorm = 46.3119, GNorm = 0.9352, lr_0 = 1.0000e-04
Validation rmse = 37.008674
Validation r2 = 0.586077
Epoch 62
Validation rmse = 37.111654
Validation r2 = 0.583770
Epoch 63
Validation rmse = 37.147021
Validation r2 = 0.582976
Epoch 64
Loss = 3.8344e-02, PNorm = 46.3169, GNorm = 0.4605, lr_0 = 1.0000e-04
Validation rmse = 37.052463
Validation r2 = 0.585096
Epoch 65
Validation rmse = 36.960472
Validation r2 = 0.587154
Epoch 66
Validation rmse = 36.739826
Validation r2 = 0.592069
Epoch 67
Loss = 3.4007e-02, PNorm = 46.3218, GNorm = 0.4715, lr_0 = 1.0000e-04
Validation rmse = 36.925113
Validation r2 = 0.587944
Epoch 68
Validation rmse = 36.697753
Validation r2 = 0.593002
Epoch 69
Validation rmse = 37.002610
Validation r2 = 0.586212
Model 0 best validation rmse = 32.722237 on epoch 4
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "encoder.encoder.1.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.1.W_i.weight".
Loading pretrained parameter "encoder.encoder.1.W_h.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.bias".
Loading pretrained parameter "encoder.encoder.2.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.2.W_i.weight".
Loading pretrained parameter "encoder.encoder.2.W_h.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.bias".
Loading pretrained parameter "encoder.encoder.3.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.3.W_i.weight".
Loading pretrained parameter "encoder.encoder.3.W_h.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test rmse = 39.143722
Model 0 test r2 = 0.630272
Ensemble test rmse = 39.143722
Ensemble test r2 = 0.630272
Fold 3
Splitting data with seed 3
Total size = 223 | train size = 178 | val size = 22 | test size = 23
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0-3): 4 x MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=600, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 709,801
Moving model to cuda
Epoch 0
Validation rmse = 68.821495
Validation r2 = 0.192053
Epoch 1
Validation rmse = 52.549782
Validation r2 = 0.528940
Epoch 2
Loss = 3.4774e-01, PNorm = 45.8761, GNorm = 2.8150, lr_0 = 9.3452e-04
Loss = 3.2242e-01, PNorm = 45.8818, GNorm = 5.4455, lr_0 = 9.2403e-04
Validation rmse = 57.825181
Validation r2 = 0.429614
Epoch 3
Validation rmse = 50.818633
Validation r2 = 0.559465
Epoch 4
Validation rmse = 49.950945
Validation r2 = 0.574380
Epoch 5
Loss = 3.1874e-01, PNorm = 45.9330, GNorm = 7.3014, lr_0 = 8.1614e-04
Validation rmse = 48.130811
Validation r2 = 0.604833
Epoch 6
Validation rmse = 55.950529
Validation r2 = 0.465998
Epoch 7
Validation rmse = 51.264861
Validation r2 = 0.551694
Epoch 8
Loss = 2.2025e-01, PNorm = 45.9692, GNorm = 3.3215, lr_0 = 7.2085e-04
Validation rmse = 50.765536
Validation r2 = 0.560385
Epoch 9
Validation rmse = 49.787799
Validation r2 = 0.577156
Epoch 10
Validation rmse = 48.305991
Validation r2 = 0.601951
Epoch 11
Loss = 1.8028e-01, PNorm = 46.0034, GNorm = 4.4537, lr_0 = 6.3668e-04
Validation rmse = 47.415550
Validation r2 = 0.616490
Epoch 12
Validation rmse = 45.491080
Validation r2 = 0.646990
Epoch 13
Validation rmse = 45.342243
Validation r2 = 0.649296
Epoch 14
Loss = 1.3611e-01, PNorm = 46.0408, GNorm = 1.7612, lr_0 = 5.5603e-04
Validation rmse = 44.921451
Validation r2 = 0.655775
Epoch 15
Validation rmse = 44.060682
Validation r2 = 0.668841
Epoch 16
Loss = 1.4731e-01, PNorm = 46.0696, GNorm = 2.4519, lr_0 = 4.9111e-04
Validation rmse = 45.346486
Validation r2 = 0.649230
Epoch 17
Validation rmse = 43.623861
Validation r2 = 0.675374
Epoch 18
Validation rmse = 44.625698
Validation r2 = 0.660293
Epoch 19
Loss = 1.3871e-01, PNorm = 46.0922, GNorm = 3.5495, lr_0 = 4.3377e-04
Validation rmse = 43.333459
Validation r2 = 0.679682
Epoch 20
Validation rmse = 42.949372
Validation r2 = 0.685335
Epoch 21
Validation rmse = 43.239134
Validation r2 = 0.681075
Epoch 22
Loss = 1.1585e-01, PNorm = 46.1128, GNorm = 0.5933, lr_0 = 3.8312e-04
Validation rmse = 42.612974
Validation r2 = 0.690245
Epoch 23
Validation rmse = 42.332912
Validation r2 = 0.694303
Epoch 24
Validation rmse = 41.548225
Validation r2 = 0.705531
Epoch 25
Loss = 1.0573e-01, PNorm = 46.1307, GNorm = 1.2485, lr_0 = 3.3839e-04
Validation rmse = 41.747242
Validation r2 = 0.702703
Epoch 26
Validation rmse = 41.165290
Validation r2 = 0.710934
Epoch 27
Validation rmse = 41.676537
Validation r2 = 0.703709
Epoch 28
Loss = 1.0044e-01, PNorm = 46.1476, GNorm = 1.1939, lr_0 = 2.9552e-04
Validation rmse = 41.345346
Validation r2 = 0.708400
Epoch 29
Validation rmse = 41.520723
Validation r2 = 0.705921
Epoch 30
Loss = 9.2995e-02, PNorm = 46.1610, GNorm = 0.6490, lr_0 = 2.6102e-04
Validation rmse = 40.773548
Validation r2 = 0.716410
Epoch 31
Validation rmse = 41.783168
Validation r2 = 0.702191
Epoch 32
Validation rmse = 40.615761
Validation r2 = 0.718600
Epoch 33
Loss = 8.6384e-02, PNorm = 46.1734, GNorm = 0.2776, lr_0 = 2.3054e-04
Validation rmse = 41.342732
Validation r2 = 0.708437
Epoch 34
Validation rmse = 40.003664
Validation r2 = 0.727018
Epoch 35
Validation rmse = 40.787724
Validation r2 = 0.716212
Epoch 36
Loss = 8.3555e-02, PNorm = 46.1850, GNorm = 0.6090, lr_0 = 2.0362e-04
Validation rmse = 40.477973
Validation r2 = 0.720506
Epoch 37
Validation rmse = 40.065340
Validation r2 = 0.726176
Epoch 38
Validation rmse = 40.255263
Validation r2 = 0.723573
Epoch 39
Loss = 6.6297e-02, PNorm = 46.1964, GNorm = 1.4896, lr_0 = 1.7783e-04
Validation rmse = 39.151193
Validation r2 = 0.738528
Epoch 40
Validation rmse = 41.045455
Validation r2 = 0.712615
Epoch 41
Validation rmse = 39.127079
Validation r2 = 0.738850
Epoch 42
Loss = 5.2986e-02, PNorm = 46.2058, GNorm = 1.6936, lr_0 = 1.5706e-04
Validation rmse = 40.433853
Validation r2 = 0.721115
Epoch 43
Validation rmse = 39.560759
Validation r2 = 0.733029
Epoch 44
Loss = 6.9699e-02, PNorm = 46.2139, GNorm = 0.5830, lr_0 = 1.3873e-04
Validation rmse = 39.534658
Validation r2 = 0.733381
Epoch 45
Validation rmse = 39.918612
Validation r2 = 0.728177
Epoch 46
Validation rmse = 38.845295
Validation r2 = 0.742598
Epoch 47
Loss = 6.6496e-02, PNorm = 46.2205, GNorm = 0.3411, lr_0 = 1.2253e-04
Loss = 5.9706e-02, PNorm = 46.2211, GNorm = 1.3249, lr_0 = 1.2115e-04
Validation rmse = 39.956760
Validation r2 = 0.727658
Epoch 48
Validation rmse = 38.931687
Validation r2 = 0.741452
Epoch 49
Validation rmse = 38.938425
Validation r2 = 0.741363
Epoch 50
Loss = 8.0327e-02, PNorm = 46.2263, GNorm = 0.3718, lr_0 = 1.0822e-04
Validation rmse = 39.467209
Validation r2 = 0.734290
Epoch 51
Validation rmse = 39.090685
Validation r2 = 0.739336
Epoch 52
Validation rmse = 38.877387
Validation r2 = 0.742173
Epoch 53
Loss = 4.9736e-02, PNorm = 46.2321, GNorm = 0.3993, lr_0 = 1.0000e-04
Validation rmse = 39.223466
Validation r2 = 0.737562
Epoch 54
Validation rmse = 38.399606
Validation r2 = 0.748471
Epoch 55
Validation rmse = 39.113065
Validation r2 = 0.739037
Epoch 56
Loss = 4.3868e-02, PNorm = 46.2372, GNorm = 1.1778, lr_0 = 1.0000e-04
Validation rmse = 38.957567
Validation r2 = 0.741108
Epoch 57
Validation rmse = 38.615743
Validation r2 = 0.745631
Epoch 58
Loss = 5.9054e-02, PNorm = 46.2424, GNorm = 2.0843, lr_0 = 1.0000e-04
Validation rmse = 38.464454
Validation r2 = 0.747621
Epoch 59
Validation rmse = 38.857950
Validation r2 = 0.742431
Epoch 60
Validation rmse = 37.959728
Validation r2 = 0.754201
Epoch 61
Loss = 5.9790e-02, PNorm = 46.2476, GNorm = 0.6141, lr_0 = 1.0000e-04
Loss = 5.6078e-02, PNorm = 46.2481, GNorm = 0.6838, lr_0 = 1.0000e-04
Validation rmse = 39.030857
Validation r2 = 0.740133
Epoch 62
Validation rmse = 38.334246
Validation r2 = 0.749326
Epoch 63
Validation rmse = 38.230361
Validation r2 = 0.750683
Epoch 64
Loss = 6.0744e-02, PNorm = 46.2535, GNorm = 1.3275, lr_0 = 1.0000e-04
Validation rmse = 37.915723
Validation r2 = 0.754770
Epoch 65
Validation rmse = 38.273733
Validation r2 = 0.750117
Epoch 66
Validation rmse = 37.878831
Validation r2 = 0.755247
Epoch 67
Loss = 4.5418e-02, PNorm = 46.2586, GNorm = 0.4379, lr_0 = 1.0000e-04
Validation rmse = 38.238257
Validation r2 = 0.750580
Epoch 68
Validation rmse = 37.642757
Validation r2 = 0.758288
Epoch 69
Validation rmse = 37.983368
Validation r2 = 0.753894
Model 0 best validation rmse = 37.642757 on epoch 68
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "encoder.encoder.1.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.1.W_i.weight".
Loading pretrained parameter "encoder.encoder.1.W_h.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.bias".
Loading pretrained parameter "encoder.encoder.2.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.2.W_i.weight".
Loading pretrained parameter "encoder.encoder.2.W_h.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.bias".
Loading pretrained parameter "encoder.encoder.3.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.3.W_i.weight".
Loading pretrained parameter "encoder.encoder.3.W_h.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test rmse = 26.583182
Model 0 test r2 = 0.769073
Ensemble test rmse = 26.583182
Ensemble test r2 = 0.769073
Fold 4
Splitting data with seed 4
Total size = 223 | train size = 178 | val size = 22 | test size = 23
Fitting scaler
Building model 0
MoleculeModel(
  (encoder): MPN(
    (encoder): ModuleList(
      (0-3): 4 x MPNEncoder(
        (dropout): Dropout(p=0.0, inplace=False)
        (act_func): ReLU()
        (W_i): Linear(in_features=147, out_features=300, bias=False)
        (W_h): Linear(in_features=300, out_features=300, bias=False)
        (W_o): Linear(in_features=433, out_features=300, bias=True)
      )
    )
  )
  (readout): Sequential(
    (0): Dropout(p=0.0, inplace=False)
    (1): Linear(in_features=600, out_features=300, bias=True)
    (2): ReLU()
    (3): Dropout(p=0.0, inplace=False)
    (4): Linear(in_features=300, out_features=1, bias=True)
  )
)
Number of parameters = 709,801
Moving model to cuda
Epoch 0
Validation rmse = 62.219859
Validation r2 = -0.435854
Epoch 1
Validation rmse = 44.494676
Validation r2 = 0.265709
Epoch 2
Loss = 5.4397e-01, PNorm = 45.8683, GNorm = 9.2713, lr_0 = 9.3452e-04
Loss = 5.1810e-01, PNorm = 45.8727, GNorm = 4.3925, lr_0 = 9.2403e-04
Validation rmse = 48.803777
Validation r2 = 0.116597
Epoch 3
Validation rmse = 37.299001
Validation r2 = 0.484004
Epoch 4
Validation rmse = 37.379716
Validation r2 = 0.481768
Epoch 5
Loss = 3.3969e-01, PNorm = 45.9180, GNorm = 3.4656, lr_0 = 8.1614e-04
Validation rmse = 37.293069
Validation r2 = 0.484168
Epoch 6
Validation rmse = 37.197074
Validation r2 = 0.486820
Epoch 7
Validation rmse = 37.197353
Validation r2 = 0.486812
Epoch 8
Loss = 2.7118e-01, PNorm = 45.9611, GNorm = 1.4560, lr_0 = 7.2085e-04
Validation rmse = 36.704875
Validation r2 = 0.500311
Epoch 9
Validation rmse = 36.483075
Validation r2 = 0.506332
Epoch 10
Validation rmse = 36.384729
Validation r2 = 0.508990
Epoch 11
Loss = 2.0785e-01, PNorm = 46.0013, GNorm = 0.9419, lr_0 = 6.3668e-04
Validation rmse = 36.800258
Validation r2 = 0.497711
Epoch 12
Validation rmse = 35.853892
Validation r2 = 0.523213
Epoch 13
Validation rmse = 35.701935
Validation r2 = 0.527245
Epoch 14
Loss = 1.7307e-01, PNorm = 46.0434, GNorm = 2.6326, lr_0 = 5.5603e-04
Validation rmse = 34.761020
Validation r2 = 0.551836
Epoch 15
Validation rmse = 34.247555
Validation r2 = 0.564978
Epoch 16
Loss = 1.3015e-01, PNorm = 46.0791, GNorm = 2.2007, lr_0 = 4.9111e-04
Validation rmse = 35.806617
Validation r2 = 0.524469
Epoch 17
Validation rmse = 33.265283
Validation r2 = 0.589574
Epoch 18
Validation rmse = 36.445929
Validation r2 = 0.507337
Epoch 19
Loss = 1.2825e-01, PNorm = 46.1093, GNorm = 1.8631, lr_0 = 4.3377e-04
Validation rmse = 32.147061
Validation r2 = 0.616704
Epoch 20
Validation rmse = 34.916237
Validation r2 = 0.547825
Epoch 21
Validation rmse = 33.143145
Validation r2 = 0.592583
Epoch 22
Loss = 1.2528e-01, PNorm = 46.1327, GNorm = 2.2510, lr_0 = 3.8312e-04
Validation rmse = 35.291253
Validation r2 = 0.538059
Epoch 23
Validation rmse = 32.402088
Validation r2 = 0.610598
Epoch 24
Validation rmse = 34.303424
Validation r2 = 0.563557
Epoch 25
Loss = 1.0078e-01, PNorm = 46.1541, GNorm = 0.5088, lr_0 = 3.3839e-04
Validation rmse = 31.497538
Validation r2 = 0.632036
Epoch 26
Validation rmse = 33.997939
Validation r2 = 0.571296
Epoch 27
Validation rmse = 31.977408
Validation r2 = 0.620739
Epoch 28
Loss = 1.2608e-01, PNorm = 46.1736, GNorm = 1.9393, lr_0 = 2.9552e-04
Validation rmse = 32.744921
Validation r2 = 0.602314
Epoch 29
Validation rmse = 31.276150
Validation r2 = 0.637190
Epoch 30
Loss = 8.2259e-02, PNorm = 46.1888, GNorm = 0.9462, lr_0 = 2.6102e-04
Validation rmse = 32.623121
Validation r2 = 0.605267
Epoch 31
Validation rmse = 31.651788
Validation r2 = 0.628423
Epoch 32
Validation rmse = 32.692802
Validation r2 = 0.603579
Epoch 33
Loss = 7.8568e-02, PNorm = 46.2030, GNorm = 2.8723, lr_0 = 2.3054e-04
Validation rmse = 30.929186
Validation r2 = 0.645195
Epoch 34
Validation rmse = 31.943594
Validation r2 = 0.621540
Epoch 35
Validation rmse = 30.798910
Validation r2 = 0.648178
Epoch 36
Loss = 6.3994e-02, PNorm = 46.2152, GNorm = 0.5603, lr_0 = 2.0362e-04
Validation rmse = 31.477504
Validation r2 = 0.632504
Epoch 37
Validation rmse = 31.470390
Validation r2 = 0.632670
Epoch 38
Validation rmse = 30.916257
Validation r2 = 0.645492
Epoch 39
Loss = 6.7568e-02, PNorm = 46.2278, GNorm = 2.3109, lr_0 = 1.7783e-04
Validation rmse = 31.533896
Validation r2 = 0.631186
Epoch 40
Validation rmse = 31.058235
Validation r2 = 0.642229
Epoch 41
Validation rmse = 31.595391
Validation r2 = 0.629746
Epoch 42
Loss = 5.7364e-02, PNorm = 46.2383, GNorm = 0.2687, lr_0 = 1.5706e-04
Validation rmse = 30.825549
Validation r2 = 0.647569
Epoch 43
Validation rmse = 31.690771
Validation r2 = 0.627507
Epoch 44
Loss = 6.1881e-02, PNorm = 46.2474, GNorm = 1.2554, lr_0 = 1.3873e-04
Validation rmse = 31.310495
Validation r2 = 0.636393
Epoch 45
Validation rmse = 31.781792
Validation r2 = 0.625365
Epoch 46
Validation rmse = 31.139097
Validation r2 = 0.640363
Epoch 47
Loss = 5.8054e-02, PNorm = 46.2557, GNorm = 0.4241, lr_0 = 1.2253e-04
Loss = 5.9909e-02, PNorm = 46.2563, GNorm = 1.7217, lr_0 = 1.2115e-04
Validation rmse = 31.294372
Validation r2 = 0.636768
Epoch 48
Validation rmse = 31.527434
Validation r2 = 0.631337
Epoch 49
Validation rmse = 30.704112
Validation r2 = 0.650341
Epoch 50
Loss = 5.6560e-02, PNorm = 46.2626, GNorm = 0.7015, lr_0 = 1.0822e-04
Validation rmse = 31.346995
Validation r2 = 0.635545
Epoch 51
Validation rmse = 31.299131
Validation r2 = 0.636657
Epoch 52
Validation rmse = 30.614630
Validation r2 = 0.652376
Epoch 53
Loss = 5.3194e-02, PNorm = 46.2697, GNorm = 0.3900, lr_0 = 1.0000e-04
Validation rmse = 31.099928
Validation r2 = 0.641267
Epoch 54
Validation rmse = 31.485905
Validation r2 = 0.632308
Epoch 55
Validation rmse = 31.106219
Validation r2 = 0.641122
Epoch 56
Loss = 6.1768e-02, PNorm = 46.2761, GNorm = 1.3214, lr_0 = 1.0000e-04
Validation rmse = 30.750585
Validation r2 = 0.649281
Epoch 57
Validation rmse = 31.480006
Validation r2 = 0.632445
Epoch 58
Loss = 5.4748e-02, PNorm = 46.2821, GNorm = 1.1959, lr_0 = 1.0000e-04
Validation rmse = 31.079583
Validation r2 = 0.641737
Epoch 59
Validation rmse = 30.686395
Validation r2 = 0.650744
Epoch 60
Validation rmse = 31.229995
Validation r2 = 0.638260
Epoch 61
Loss = 5.0760e-02, PNorm = 46.2881, GNorm = 0.7351, lr_0 = 1.0000e-04
Loss = 4.4143e-02, PNorm = 46.2887, GNorm = 1.1818, lr_0 = 1.0000e-04
Validation rmse = 31.028104
Validation r2 = 0.642922
Epoch 62
Validation rmse = 30.575806
Validation r2 = 0.653257
Epoch 63
Validation rmse = 30.623865
Validation r2 = 0.652166
Epoch 64
Loss = 5.1823e-02, PNorm = 46.2948, GNorm = 0.3210, lr_0 = 1.0000e-04
Validation rmse = 31.277482
Validation r2 = 0.637160
Epoch 65
Validation rmse = 30.948199
Validation r2 = 0.644759
Epoch 66
Validation rmse = 31.345406
Validation r2 = 0.635582
Epoch 67
Loss = 3.5077e-02, PNorm = 46.3006, GNorm = 1.1102, lr_0 = 1.0000e-04
Validation rmse = 31.204056
Validation r2 = 0.638861
Epoch 68
Validation rmse = 31.087459
Validation r2 = 0.641555
Epoch 69
Validation rmse = 30.968254
Validation r2 = 0.644299
Model 0 best validation rmse = 30.575806 on epoch 62
Loading pretrained parameter "encoder.encoder.0.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.0.W_i.weight".
Loading pretrained parameter "encoder.encoder.0.W_h.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.weight".
Loading pretrained parameter "encoder.encoder.0.W_o.bias".
Loading pretrained parameter "encoder.encoder.1.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.1.W_i.weight".
Loading pretrained parameter "encoder.encoder.1.W_h.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.weight".
Loading pretrained parameter "encoder.encoder.1.W_o.bias".
Loading pretrained parameter "encoder.encoder.2.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.2.W_i.weight".
Loading pretrained parameter "encoder.encoder.2.W_h.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.weight".
Loading pretrained parameter "encoder.encoder.2.W_o.bias".
Loading pretrained parameter "encoder.encoder.3.cached_zero_vector".
Loading pretrained parameter "encoder.encoder.3.W_i.weight".
Loading pretrained parameter "encoder.encoder.3.W_h.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.weight".
Loading pretrained parameter "encoder.encoder.3.W_o.bias".
Loading pretrained parameter "readout.1.weight".
Loading pretrained parameter "readout.1.bias".
Loading pretrained parameter "readout.4.weight".
Loading pretrained parameter "readout.4.bias".
Moving model to cuda
Model 0 test rmse = 19.438323
Model 0 test r2 = 0.911242
Ensemble test rmse = 19.438323
Ensemble test r2 = 0.911242
5-fold cross validation
	Seed 0 ==> test rmse = 25.199607
	Seed 0 ==> test r2 = 0.856926
	Seed 1 ==> test rmse = 25.019933
	Seed 1 ==> test r2 = 0.909197
	Seed 2 ==> test rmse = 39.143722
	Seed 2 ==> test r2 = 0.630272
	Seed 3 ==> test rmse = 26.583182
	Seed 3 ==> test r2 = 0.769073
	Seed 4 ==> test rmse = 19.438323
	Seed 4 ==> test r2 = 0.911242
Overall test rmse = 27.076953 +/- 6.510839
Overall test r2 = 0.815342 +/- 0.105949
Elapsed time = 0:01:29
